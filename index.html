<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Wordpress on Heroku : Deploy Wordpress to Heroku">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Wordpress on Heroku</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/CubicApps/heroku-buildpack-wordpress">View on GitHub</a>

          <h1 id="project_title">Wordpress on Heroku</h1>
          <h2 id="project_tagline">Deploy Wordpress to Heroku</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/CubicApps/heroku-buildpack-wordpress/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/CubicApps/heroku-buildpack-wordpress/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="heroku-buildpack-wordpress-on-heroku" class="anchor" href="#heroku-buildpack-wordpress-on-heroku"><span class="octicon octicon-link"></span></a>Heroku buildpack: WordPress on Heroku</h1>

<p><em>This is a Heroku buildpack for running <a href="http://wordpress.org">WordPress</a> on <a href="http://heroku.com">Heroku</a></em></p>

<h2>
<a name="summary" class="anchor" href="#summary"><span class="octicon octicon-link"></span></a>Summary</h2>

<p>This project is based on the <a href="https://github.com/mchung/heroku-buildpack-wordpress">heroku-buildpack-wordpress project by Marc Chung</a>. It can be used with this <a href="http://github.com/mchung/wordpress-on-heroku">WordPress</a> project template to bootstrap a highly tuned WordPress site built on the following stack:</p>

<ul>
<li>
<code>nginx</code> - Nginx for serving web content.  Built specifically for Heroku.  <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/support/heroku_package_nginx.sh">See compile options</a>.</li>
<li>
<code>php</code> - PHP-FPM for process management.  <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/support/heroku_package_php.sh">See compile options</a>.</li>
<li>
<code>wordpress</code> - Downloaded directly <a href="http://wordpress.org/download/release-archive/">from wordpress.org</a>.</li>
<li>
<code>MySQL</code> - ClearDB for the MySQL backend.</li>
<li>
<code>Sendgrid</code> - Sendgrid for the email backend.</li>
<li>
<code>MemCachier</code> - MemCachier for the memcached backend.</li>
<li>
<code>Logentries</code> - Logentries for log management.</li>
</ul><h2>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h2>

<p>This buildpack bootstraps a WordPress site using the <a href="http://github.com/mchung/wordpress-on-heroku">mchung/wordpress-on-heroku</a> project template.  That repo contains everything required to run your own WordPress site on Heroku.</p>

<p>This buildpack makes it possible to compile PHP and Nginx binaries on Heroku using the preferred <code>heroku run</code> command (due to <a href="https://github.com/heroku/vulcan">heroku vulcan being depreciated</a>). These binaries are then uploaded to your Dropbox folder instead of Amazon S3 to reduce costs.</p>

<p>Each time WordPress is deployed, Heroku will fetch this buildpack from GitHub and execute the instructions in <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/bin/compile">bin/compile</a> and <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/bin/release">bin/release</a>.</p>

<h2>
<a name="compile-vendored-packages" class="anchor" href="#compile-vendored-packages"><span class="octicon octicon-link"></span></a>Compile Vendored Packages</h2>

<p>If your like me and you like to compile your own <a href="http://php.net/downloads.php">PHP</a> and <a href="http://nginx.org/download/">Nginx</a> binaries instead of relying on those compiled by someone else, then this section is for you. The <code>support</code> directory contains a handful of compilation and deployment scripts to automate several processes, which are currently used for maintenance and repo management.</p>

<ul>
<li>
<code>heroku_package_all.sh</code> - Used to compile and upload the latest version of Nginx and PHP to Dropbox.</li>
<li>
<code>heroku_package_nginx.sh</code> - Used to compile and upload the latest version of Nginx to Dropbox.</li>
<li>
<code>heroku_package_php.sh</code> - Used to compile and upload the latest version of PHP to Dropbox.</li>
</ul><p>For reference purposes, the original scripts from the forked project are:</p>

<ul>
<li>
<code>package_nginx</code> - Used to compile and upload the latest version of Nginx to S3</li>
<li>
<code>package_php</code> - Used to compile and upload the latest version of PHP to S3.</li>
<li>
<code>wordup</code> - Really useful helper script for creating and destroying WordPress sites.</li>
</ul><blockquote>
<p>If your using Windows or you would like to operate in a fresh virtual machine then a <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/Vagrantfile">Vagrantfile</a> has been included. For instructions on how to use this <code>Vagrantfile</code> see the <a href="http://www.vagrantup.com/">Vagrant website</a>.</p>
</blockquote>

<h3>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h3>

<ol>
<li>
<p>First clone this repo and create a new heroku app (replace <code>&lt;app-name&gt;</code> with the name of your app):</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>git clone https://github.com/CubicApps/heroku-buildpack-wordpress &lt;app-name&gt;
<span class="nv">$ </span><span class="nb">cd</span> &lt;app-name&gt;
<span class="nv">$ </span>heroku apps:create &lt;app-name&gt; --remote &lt;remote-name&gt; --region &lt;location&gt;
</pre></div>
</li>
<li>
<p>Then set these Heroku environment variables to your preferred versions using <code>$ heroku config:set</code>:</p>

<pre><code>PHP_VERSION=5.5.15
NGINX_VERSION=1.7.3
PCRE_VERSION=8.35
</code></pre>

<p>For example, to build Nginx v1.7.3 with PCRE v8.35 execute these commands:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>heroku config:set <span class="nv">NGINX_VERSION</span><span class="o">=</span>1.7.3 --app &lt;app-name&gt;
<span class="nv">$ </span>heroku config:set <span class="nv">PCRE_VERSION</span><span class="o">=</span>8.35 --app &lt;app-name&gt;
</pre></div>
</li>
<li>
<p>Push the repo to Heroku:</p>

<p>For the master branch use:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>git push &lt;remote-name&gt; master
</pre></div>

<p>For a local branch use:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>git push &lt;remote-name&gt; &lt;<span class="nb">local</span>-branch&gt;:master
</pre></div>
</li>
<li>
<p>Create a new one-off Heroku dyno and compile both PHP and Nginx:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>heroku run bash --app &lt;app-name&gt;
<span class="nv">$ </span>bash support/heroku_package_all.sh
</pre></div>

<p>Alternatively, if you only want to build PHP or Nginx, then you can execute <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/support/heroku_package_php.sh">/support/heroku_package_php.sh</a> or <a href="https://github.com/CubicApps/heroku-buildpack-wordpress/blob/master/support/heroku_package_nginx.sh">/support/heroku_package_nginx.sh</a> instead.</p>
</li>
<li>
<p>When you're requested to authorise your Dropbox account, follow the on-screen instructions. </p>

<p>For reference:</p>

<ul>
<li>Dropbox Developer Apps URL =  <a href="https://www.dropbox.com/developers/apps">https://www.dropbox.com/developers/apps</a> </li>
<li>Dropbox authorisation link = <a href="https://www2.dropbox.com/1/oauth/authorize?oauth_token=">https://www2.dropbox.com/1/oauth/authorize?oauth_token=<code>&lt;token_value&gt;</code></a>.</li>
</ul>
</li>
</ol><blockquote>
<p>Note: If your using a text editor on Windows to create bash scripts, such as Notepad++, then make sure all carriage return characters <code>\r</code> are removed to prevent errors when executing the scripts.</p>
</blockquote>

<h2>
<a name="bootstrapping-a-wordpress-site" class="anchor" href="#bootstrapping-a-wordpress-site"><span class="octicon octicon-link"></span></a>Bootstrapping a WordPress Site</h2>

<p>This buildpack bootstraps a WordPress site using the <a href="http://github.com/mchung/wordpress-on-heroku">mchung/wordpress-on-heroku</a> project template. That repo contains almost everything required to run your own WordPress site on Heroku. The only thing you need to add to your WordPress site is a <code>USE_DROPBOX</code> environment variable to control where the compiled binaries should be downloaded from (Dropbox or S3).</p>

<h3>
<a name="using-dropbox" class="anchor" href="#using-dropbox"><span class="octicon octicon-link"></span></a>Using Dropbox</h3>

<p>To use Dropbox you must set the following environment variables:</p>

<ul>
<li>
<code>USE_DROPBOX</code> - Set to <code>true</code>.</li>
<li>
<code>DROP_NGINX_URL</code> - Set to your Nginx Dropbox URL.</li>
<li>
<code>DROP_PHP_URL</code> - Set to your PHP Dropbox URL.</li>
</ul><p>For example:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>heroku config:set <span class="nv">USE_DROPBOX</span><span class="o">=</span><span class="nb">true</span> --app &lt;app-name&gt;
<span class="nv">$ </span>heroku config:set <span class="nv">DROP_NGINX_URL</span><span class="o">=</span>https://www.dropbox.com/s/123456/nginx-1.7.3-heroku.tar.gz --app &lt;app-name&gt;
<span class="nv">$ </span>heroku config:set <span class="nv">DROP_PHP_URL</span><span class="o">=</span>https://www.dropbox.com/s/1234567/php-5.5.15-with-fpm-heroku.tar.gz --app &lt;app-name&gt;
</pre></div>

<h3>
<a name="using-pre-compiled-packages-on-s3" class="anchor" href="#using-pre-compiled-packages-on-s3"><span class="octicon octicon-link"></span></a>Using Pre-compiled Packages on S3</h3>

<p>If you would like to use the pre-compiled vendor packages by <a href="https://github.com/mchung">@mchung</a> then you should set the <code>USE_DROPBOX</code> environment variable to <code>false</code> in your WordPress site.</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>heroku config:set <span class="nv">USE_DROPBOX</span><span class="o">=</span><span class="nb">false</span> --app &lt;app-name&gt;
</pre></div>

<p>See <a href="VERSIONS.md">VERSIONS</a> for the specific versions of Nginx and PHP you can install.</p>

<h2>
<a name="wordpress-version" class="anchor" href="#wordpress-version"><span class="octicon octicon-link"></span></a>WordPress Version</h2>

<p>This buildpack automatically installs the most current version of WordPress. However, if you would like to install an older version of WordPress, then set the <code>BUILDPACK_WORDPRESS_VERSION</code> environment variable to the version you would like to install.</p>

<p>For example, to install WordPress v3.8.2 use:</p>

<div class="highlight highlight-bash"><pre><span class="nv">$ </span>heroku config:set <span class="nv">BUILDPACK_WORDPRESS_VERSION</span><span class="o">=</span>3.8.2 --app &lt;app-name&gt;
</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Wordpress on Heroku maintained by <a href="https://github.com/CubicApps">CubicApps</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
